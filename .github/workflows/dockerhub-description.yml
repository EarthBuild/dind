name: Update Docker Hub description

on:
  push:
    # branches: [ main ]
    # paths: [ README.md ]

jobs:
  update:
    runs-on: ubuntu-24.04-arm
    steps:
      - uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
      - name: Update DockerHub description
        run: |
          DESCRIPTION='The `dind` image is designed for EarthBuild targets that use the `WITH DOCKER` command'
          FULL_DESCRIPTION=$(jq -Rs . < README.md)
          curl -X PATCH \
            -H "Authorization: Bearer ${{ secrets.DOCKERHUB_TOKEN }}" \
            -H "Content-Type: application/json" \
            -d "{\"description\": \"$DESCRIPTION\", \"full_description\": $FULL_DESCRIPTION}" \
            https://hub.docker.com/v2/repositories/earthbuild/dind/
